"use strict";(self.webpackChunkproductionproject=self.webpackChunkproductionproject||[]).push([[780],{7780:(e,n,a)=>{a.r(n),a.d(n,{default:()=>J});var r,o=a(5893);!function(e){e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR"}(r||(r={}));var t=a(7168),i=(0,t.hg)("profile/fetchProfileData",(function(e,n){return a=void 0,r=void 0,t=function(){var a,r,o,t;return function(e,n){var a,r,o,t,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function l(t){return function(l){return function(t){if(a)throw new TypeError("Generator is already executing.");for(;i;)try{if(a=1,r&&(o=2&t[0]?r.return:t[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,t[1])).done)return o;switch(r=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return i.label++,{value:t[1],done:!1};case 5:i.label++,r=t[1],t=[0];continue;case 7:t=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==t[0]&&2!==t[0])){i=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){i.label=t[1];break}if(6===t[0]&&i.label<o[1]){i.label=o[1],o=t;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(t);break}o[2]&&i.ops.pop(),i.trys.pop();continue}t=n.call(e,i)}catch(e){t=[6,e],r=0}finally{a=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,l])}}}(this,(function(i){switch(i.label){case 0:a=n.extra,r=n.rejectWithValue,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a.api.get("/profile/".concat(e))];case 2:if(!(o=i.sent()).data)throw new Error;return[2,o.data];case 3:return t=i.sent(),console.log(t),[2,r("Error")];case 4:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,n){function i(e){try{u(t.next(e))}catch(e){n(e)}}function l(e){try{u(t.throw(e))}catch(e){n(e)}}function u(n){var a;n.done?e(n.value):(a=n.value,a instanceof o?a:new o((function(e){e(a)}))).then(i,l)}u((t=t.apply(a,r||[])).next())}));var a,r,o,t})),l=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.form},u=(0,t.hg)("profile/updateProfileData",(function(e,n){return a=void 0,o=void 0,i=function(){var e,a,o,t,i,u,c;return function(e,n){var a,r,o,t,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return t={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function l(t){return function(l){return function(t){if(a)throw new TypeError("Generator is already executing.");for(;i;)try{if(a=1,r&&(o=2&t[0]?r.return:t[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,t[1])).done)return o;switch(r=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return i.label++,{value:t[1],done:!1};case 5:i.label++,r=t[1],t=[0];continue;case 7:t=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==t[0]&&2!==t[0])){i=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){i.label=t[1];break}if(6===t[0]&&i.label<o[1]){i.label=o[1],o=t;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(t);break}o[2]&&i.ops.pop(),i.trys.pop();continue}t=n.call(e,i)}catch(e){t=[6,e],r=0}finally{a=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,l])}}}(this,(function(s){switch(s.label){case 0:if(e=n.extra,a=n.rejectWithValue,o=n.getState,t=l(o()),(i=function(e){if(!e)return[r.NO_DATA];var n=e.first,a=e.lastname,o=e.age,t=e.country,i=[];return n&&a||i.push(r.INCORRECT_USER_DATA),o&&Number.isInteger(o)||i.push(r.INCORRECT_AGE),t||i.push(r.INCORRECT_COUNTRY),i}(t)).length)return[2,a(i)];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,e.api.put("/profile/".concat((null==t?void 0:t.id)||""),t)];case 2:if(!(u=s.sent()).data)throw new Error;return[2,u.data];case 3:return c=s.sent(),console.log(c),[2,a([r.SERVER_ERROR])];case 4:return[2]}}))},new((t=void 0)||(t=Promise))((function(e,n){function r(e){try{u(i.next(e))}catch(e){n(e)}}function l(e){try{u(i.throw(e))}catch(e){n(e)}}function u(n){var a;n.done?e(n.value):(a=n.value,a instanceof t?a:new t((function(e){e(a)}))).then(r,l)}u((i=i.apply(a,o||[])).next())}));var a,o,t,i})),c=function(){return c=Object.assign||function(e){for(var n,a=1,r=arguments.length;a<r;a++)for(var o in n=arguments[a])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},c.apply(this,arguments)},s=(0,t.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:function(e,n){e.readonly=n.payload},cancelEdit:function(e){e.readonly=!0,e.validateError=void 0,e.form=e.data},updateProfile:function(e,n){e.form=c(c({},e.form),n.payload)}},extraReducers:function(e){e.addCase(i.pending,(function(e,n){e.error=void 0,e.isLoading=!0})).addCase(i.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload})).addCase(i.rejected,(function(e,n){e.isLoading=!1,e.error=n.payload})).addCase(u.pending,(function(e,n){e.validateError=void 0,e.isLoading=!0})).addCase(u.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload,e.readonly=!0,e.validateError=void 0})).addCase(u.rejected,(function(e,n){e.isLoading=!1,e.validateError=n.payload}))}}),d=s.actions,v=s.reducer,f=a(4611),p=a(2327),h=a(4809),C=a(6925),y=a(4002),g=a(71);const R={ProfileCard:"wW9jg",input:"ZTyX8",loading:"t07Zx",error:"i5YK3",avatarWrapper:"bEFNS",editing:"DjTe7"};var m;!function(e){e.RUB="RUB",e.EUR="EUR",e.USD="USD"}(m||(m={}));var b=a(7294),E=a(7808),x=[{value:m.RUB,content:m.RUB},{value:m.EUR,content:m.EUR},{value:m.USD,content:m.USD}];const N=(0,b.memo)((function(e){var n=e.className,a=e.value,r=e.onChange,t=e.readonly,i=(0,p.$)("profile").t,l=(0,b.useCallback)((function(e){null==r||r(e)}),[r]);return(0,o.jsx)(E.P,{className:(0,f.A)("",{},[n]),label:i("Choose a currency"),options:x,value:a,onChange:l,readonly:t},void 0)}));var j;!function(e){e.Russia="Russia",e.Ukraine="Ukraine",e.Armenia="Armenia"}(j||(j={}));var O=[{value:j.Russia,content:j.Russia},{value:j.Ukraine,content:j.Ukraine},{value:j.Armenia,content:j.Armenia}];const A=(0,b.memo)((function(e){var n=e.className,a=e.value,r=e.onChange,t=e.readonly,i=(0,p.$)("profile").t,l=(0,b.useCallback)((function(e){null==r||r(e)}),[r]);return(0,o.jsx)(E.P,{className:(0,f.A)("",{},[n]),label:i("Choose a country"),options:O,value:a,onChange:l,readonly:t},void 0)}));var T=function(){return T=Object.assign||function(e){for(var n,a=1,r=arguments.length;a<r;a++)for(var o in n=arguments[a])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},T.apply(this,arguments)},k=function(e){var n,a=e.className,r=e.data,t=e.isLoading,i=e.error,l=e.readonly,u=e.onChangeFirstname,c=e.onChangeLastname,s=e.onChangeCity,d=e.onChangeAge,v=e.onChangeUsername,m=e.onChangeAvatar,b=e.onChangeCountry,E=e.onChangeCurrency,x=(0,p.$)("profile").t;if(t)return(0,o.jsx)("div",T({className:(0,f.A)(R.ProfileCard,{},[a,R.loading])},{children:(0,o.jsx)(y.Z,{},void 0)}),void 0);if(i)return(0,o.jsx)("div",T({className:(0,f.A)(R.ProfileCard,{},[a,R.error])},{children:(0,o.jsx)(h.xv,{theme:h.lg.ERROR,title:x("Mistake is happened"),text:x("Try again"),align:h.PH.CENTER},void 0)}),void 0);var j=((n={})[R.editing]=!l,n);return(0,o.jsx)("div",T({className:(0,f.A)(R.ProfileCard,j,[a])},{children:(0,o.jsxs)("div",T({className:R.data},{children:[(null==r?void 0:r.avatar)&&(0,o.jsx)("div",T({className:R.avatarWrapper},{children:(0,o.jsx)(g.q,{src:null==r?void 0:r.avatar},void 0)}),void 0),(0,o.jsx)(C.I,{value:null==r?void 0:r.first,placeholder:x("Your name"),className:R.input,onChange:u,readonly:l},void 0),(0,o.jsx)(C.I,{value:null==r?void 0:r.lastname,placeholder:x("Your surname"),className:R.input,onChange:c,readonly:l},void 0),(0,o.jsx)(C.I,{onKeyPress:function(e){/[0-9]/.test(e.key)||e.preventDefault()},value:null==r?void 0:r.age,placeholder:x("Age"),className:R.input,onChange:d,readonly:l},void 0),(0,o.jsx)(C.I,{value:null==r?void 0:r.city,placeholder:x("City"),className:R.input,onChange:s,readonly:l},void 0),(0,o.jsx)(C.I,{value:null==r?void 0:r.username,placeholder:x("Username"),className:R.input,onChange:v,readonly:l},void 0),(0,o.jsx)(C.I,{value:null==r?void 0:r.avatar,placeholder:x("Avatar"),className:R.input,onChange:m,readonly:l},void 0),(0,o.jsx)(N,{className:R.input,value:null==r?void 0:r.currency,onChange:E,readonly:l},void 0),(0,o.jsx)(A,{className:R.input,value:null==r?void 0:r.country,onChange:b,readonly:l},void 0)]}),void 0)}),void 0)},w=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.error},P=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.isLoading},U=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.data},I=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.readonly},_=function(e){var n;return null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.validateError},S=a(9250),D=a(1150),L=a(5461),B=a(6372),W=a(9161),Y=a(3574);const G={ProfilePageHeader:"FPJSg",editBtn:"vP5lJ",btnWrapper:"LxXAb"};var V=function(){return V=Object.assign||function(e){for(var n,a=1,r=arguments.length;a<r;a++)for(var o in n=arguments[a])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},V.apply(this,arguments)};const F=function(e){var n=e.className,a=(0,p.$)("profile").t,r=(0,B.v9)(I),t=(0,B.v9)(Y.m5),i=(0,B.v9)(U),l=(0,L.T)(),c=(null==t?void 0:t.id)===(null==i?void 0:i.id),s=(0,b.useCallback)((function(){l(d.setReadonly(!1))}),[l]),v=(0,b.useCallback)((function(){l(d.cancelEdit())}),[l]),C=(0,b.useCallback)((function(){l(u())}),[l]);return(0,o.jsxs)("div",V({className:(0,f.A)(G.ProfilePageHeader,{},[n])},{children:[(0,o.jsx)(h.xv,{title:a("Profile")},void 0),c&&(0,o.jsx)("div",V({className:G.btnWrapper},{children:r?(0,o.jsx)(W.zx,V({className:G.editBtn,theme:W.bn.OUTLINE,onClick:s},{children:a("Edit")}),void 0):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(W.zx,V({className:G.editBtn,theme:W.bn.OUTLINE_RED,onClick:v},{children:a("Cancel")}),void 0),(0,o.jsx)(W.zx,V({className:G.saveBtn,theme:W.bn.OUTLINE,onClick:C},{children:a("Save")}),void 0)]},void 0)}),void 0)]}),void 0)};var $=a(2276),Z=a(314),z=function(){return z=Object.assign||function(e){for(var n,a=1,r=arguments.length;a<r;a++)for(var o in n=arguments[a])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},z.apply(this,arguments)},H={profile:v};const J=function(e){var n,a=e.className,t=(0,p.$)("profile"),u=t.t,c=(t.i18n,(0,L.T)()),s=(0,B.v9)(l),v=(0,B.v9)(P),C=(0,B.v9)(w),y=(0,B.v9)(I),g=(0,B.v9)(_),R=(0,S.UO)().id,m=((n={})[r.SERVER_ERROR]=u("Server error"),n[r.NO_DATA]=u("Data is absented"),n[r.INCORRECT_USER_DATA]=u("Incorrect user data"),n[r.INCORRECT_COUNTRY]=u("Incorrect country"),n[r.INCORRECT_AGE]=u("Incorrect age"),n);(0,$.Q)((function(){R&&c(i(R))}));var E=(0,b.useCallback)((function(e){c(d.updateProfile({first:e||""}))}),[c]),x=(0,b.useCallback)((function(e){c(d.updateProfile({lastname:e||""}))}),[c]),N=(0,b.useCallback)((function(e){c(d.updateProfile({age:Number(e||0)}))}),[c]),j=(0,b.useCallback)((function(e){c(d.updateProfile({city:e||""}))}),[c]),O=(0,b.useCallback)((function(e){c(d.updateProfile({username:e||""}))}),[c]),A=(0,b.useCallback)((function(e){c(d.updateProfile({avatar:e||""}))}),[c]),T=(0,b.useCallback)((function(e){c(d.updateProfile({currency:e}))}),[c]),U=(0,b.useCallback)((function(e){c(d.updateProfile({country:e}))}),[c]);return(0,o.jsx)(D.W,z({reducers:H,removeAfterUnmount:!0},{children:(0,o.jsxs)(Z.Z,z({className:(0,f.A)("",{},[a])},{children:[(0,o.jsx)(F,{},void 0),(null==g?void 0:g.length)&&g.map((function(e){return(0,o.jsx)(h.xv,{theme:h.lg.ERROR,text:m[e]},e)})),(0,o.jsx)(k,{data:s,isLoading:v,error:C,onChangeFirstname:E,onChangeLastname:x,onChangeAge:N,onChangeCity:j,onChangeUsername:O,onChangeAvatar:A,onChangeCurrency:T,onChangeCountry:U,readonly:y},void 0)]}),void 0)}),void 0)}}}]);