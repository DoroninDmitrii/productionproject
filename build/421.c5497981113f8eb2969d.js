"use strict";(self.webpackChunkproductionproject=self.webpackChunkproductionproject||[]).push([[421],{9035:(e,t,r)=>{r.r(t),r.d(t,{ArticleDetailsPage:()=>Q,default:()=>T});var a=r(3007),n=r(4478),i=r(7294),s=r(622),c=r(9250),o=r(1233),l=r(8979),u=r(7779),d=r(4268),m=r(5861),x=r(4687),p=r.n(x),f=(0,d.hg)("articleDetails/fetchCommentsByArticleId",function(){var e=(0,m.Z)(p().mark((function e(t,r){var a,n,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.extra,n=r.rejectWithValue,t){e.next=3;break}return e.abrupt("return",n("error"));case 3:return e.prev=3,e.next=6,a.api.get("/comments",{params:{articleId:t,_expand:"user"}});case 6:if((i=e.sent).data){e.next=9;break}throw new Error;case 9:return e.abrupt("return",i.data);case 12:return e.prev=12,e.t0=e.catch(3),console.log(e.t0),e.abrupt("return",n("Error"));case 16:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t,r){return e.apply(this,arguments)}}()),g=(0,d.HF)({selectId:function(e){return e.id}}),h=g.getSelectors((function(e){var t;return(null===(t=e.articleDetailsPage)||void 0===t?void 0:t.comments)||g.getInitialState()})),v=(0,d.oM)({name:"articleDetailsCommentsSlice",initialState:g.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{}}),reducers:{},extraReducers:function(e){e.addCase(f.pending,(function(e,t){e.error=void 0,e.isLoading=!0})).addCase(f.fulfilled,(function(e,t){e.isLoading=!1,g.setAll(e,t.payload)})).addCase(f.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}).reducer,j=(0,d.hg)("articleDetailsPage/fetchArticleRecommendations",function(){var e=(0,m.Z)(p().mark((function e(t,r){var a,n,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.extra,n=r.rejectWithValue,e.prev=1,e.next=4,a.api.get("/articles",{params:{_limit:4}});case 4:if((i=e.sent).data){e.next=7;break}throw new Error;case 7:return e.abrupt("return",i.data);case 10:return e.prev=10,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return",n("Error"));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,r){return e.apply(this,arguments)}}()),b=(0,d.HF)({selectId:function(e){return e.id}}),w=(b.getSelectors((function(e){var t;return(null===(t=e.articleDetailsPage)||void 0===t?void 0:t.recommendations)||b.getInitialState()})),(0,d.oM)({name:"articleDetaisPageRecommendationsSlice",initialState:b.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{}}),reducers:{},extraReducers:function(e){e.addCase(j.pending,(function(e,t){e.error=void 0,e.isLoading=!0})).addCase(j.fulfilled,(function(e,t){e.isLoading=!1,b.setAll(e,t.payload)})).addCase(j.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}).reducer),C=(0,u.UY)({recommendations:w,comments:v}),N=r(9319),L=r(3694),k=r(5255),A=r(3381),y=(0,r(2222).P1)(s.wq,A.m5,(function(e,t){return!(!e||!t)&&e.user.id===t.id})),I=r(2047),D=r(5893);const S=(0,i.memo)((function(e){var t=e.className,r=(0,n.$)("article-details"),o=r.t,l=(r.i18n,(0,c.s0)()),u=((0,N.v9)(A.m5),(0,N.v9)(s.wq)),d=(0,N.v9)(y),m=(0,i.useCallback)((function(){l(L.h3.articles)}),[l]),x=(0,i.useCallback)((function(){l("".concat(L.h3.articles_details,"/").concat(null==u?void 0:u.id,"/edit"))}),[l,null==u?void 0:u.id]);return(0,D.jsxs)(I.U,{max:!0,justify:"between",className:(0,a.A)("",{},[t]),children:[(0,D.jsx)(k.zx,{theme:k.bn.OUTLINE,onClick:m,children:o("Back to list")}),d&&(0,D.jsx)(k.zx,{theme:k.bn.OUTLINE,onClick:x,children:o("Edit")})]})}));var E=r(1715),P=r(6628).p.injectEndpoints({endpoints:function(e){return{getArticleRecommendationsList:e.query({query:function(e){return{url:"/articles",params:{_limit:e}}}})}}}).useGetArticleRecommendationsListQuery,R=(0,i.memo)((function(e){var t=e.className,r=(0,n.$)(),i=r.t,c=(r.i18n,P(3)),o=c.isLoading,l=c.data,u=c.error;return o||u||!l?null:(0,D.jsxs)(I.g,{gap:"8",className:(0,a.A)("",{},[t]),children:[(0,D.jsx)(E.xv,{size:E.yH.L,title:i("Recommendations")}),(0,D.jsx)(s.wD,{articles:l,target:"_blank"})]})})),q=(0,i.lazy)((0,m.Z)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(933).then(r.bind(r,1933));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),z=r(2949),H=r(3312),O=r(6897);const U={CommentCard:"xIHBy",header:"dsH_3",username:"dw82W",loading:"V0iZ1"},Z=(0,i.memo)((function(e){var t=e.className,r=e.comment;return e.isLoading?(0,D.jsxs)("div",{className:(0,a.A)(U.CommentCard,{},[t,U.loading]),children:[(0,D.jsxs)("div",{className:U.header,children:[(0,D.jsx)(H.O,{width:30,height:30,border:"50%"}),(0,D.jsx)(H.O,{height:16,width:100,className:U.username})]}),(0,D.jsx)(H.O,{className:U.text,width:"100%",height:50})]}):r?(0,D.jsxs)(I.g,{gap:"8",max:!0,className:(0,a.A)(U.CommentCard,{},[t]),children:[(0,D.jsxs)(O.F,{to:"".concat(L.h3.profile,"/").concat(r.user.id),className:U.header,children:[r.user.avatar?(0,D.jsx)(z.q,{size:30,src:r.user.avatar}):null,(0,D.jsx)(E.xv,{className:U.username,title:r.user.username})]}),(0,D.jsx)(E.xv,{className:U.text,text:r.text})]}):null}));var _=(0,i.memo)((function(e){var t=e.className,r=e.comments,i=e.isLoading,s=(0,n.$)(),c=s.t;return s.i18n,i?(0,D.jsxs)(I.g,{gap:"16",max:!0,className:(0,a.A)("",{},[t]),children:[(0,D.jsx)(Z,{isLoading:!0}),(0,D.jsx)(Z,{isLoading:!0}),(0,D.jsx)(Z,{isLoading:!0})]}):(0,D.jsx)(I.g,{gap:"16",max:!0,className:(0,a.A)("",{},[t]),children:null!=r&&r.length?r.map((function(e){return(0,D.jsx)(Z,{isLoading:i,comment:e},e.id)})):(0,D.jsx)(E.xv,{text:c("No comments")})})})),W=r(9970),$=function(e){var t,r;return null===(t=e.articleDetailsPage)||void 0===t||null===(r=t.comments)||void 0===r?void 0:r.isLoading},F=r(3547),V=(0,d.hg)("articleDetails/addCommentForArticle",function(){var e=(0,m.Z)(p().mark((function e(t,r){var a,n,i,s,c,o,l;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.extra,n=r.rejectWithValue,i=r.getState,s=r.dispatch,c=(0,A.m5)(i()),o=(0,F.wq)(i()),c&&t&&o){e.next=5;break}return e.abrupt("return",n("no data"));case 5:return e.prev=5,e.next=8,a.api.post("/comments",{articleId:o.id,userId:c.id,text:t});case 8:if((l=e.sent).data){e.next=11;break}throw new Error;case 11:return s(f(o.id)),e.abrupt("return",l.data);case 15:return e.prev=15,e.t0=e.catch(5),e.abrupt("return",n("Error"));case 18:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t,r){return e.apply(this,arguments)}}());const B=(0,i.memo)((function(e){var t=e.className,r=e.id,s=(0,n.$)("article-details"),c=s.t,o=(s.i18n,(0,N.I0)()),l=(0,N.v9)(h.selectAll),u=(0,N.v9)($),d=(0,i.useCallback)((function(e){o(V(e))}),[o]);return(0,W.Q)((function(){o(f(r))})),(0,D.jsxs)(I.g,{gap:"16",max:!0,className:(0,a.A)("",{},[t]),children:[(0,D.jsx)(E.xv,{size:E.yH.L,className:"",title:c("Comments")}),(0,D.jsx)(q,{onSendComment:d}),(0,D.jsx)(_,{isLoading:u,comments:l})]})}));var M={articleDetailsPage:C},Q=function(e){var t=e.className,r=(0,n.$)("article-details"),i=(r.t,r.i18n,(0,c.UO)().id);return(0,D.jsx)(o.W,{reducers:M,removeAfterUnmount:!0,children:(0,D.jsx)(l.Z,{className:(0,a.A)("adu8f",{},[t]),children:(0,D.jsxs)(I.g,{gap:"16",max:!0,children:[(0,D.jsx)(S,{}),(0,D.jsx)(s.D0,{id:i}),(0,D.jsx)(R,{}),(0,D.jsx)(B,{id:i})]})})})};const T=(0,i.memo)(Q)}}]);