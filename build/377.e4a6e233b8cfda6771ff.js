"use strict";(self.webpackChunkproductionproject=self.webpackChunkproductionproject||[]).push([[377],{7776:function(e,a,t){t.r(a),t.d(a,{ArticleDetailsPage:function(){return Z},default:function(){return G}});var s=t(3007),i=t(2327),r=t(7294),n=t(622),c=t(9250),l=t(1233),d=t(8979),o=t(7779),m=t(4268);const u=(0,m.hg)("articleDetails/fetchCommentsByArticleId",(async(e,a)=>{const{extra:t,rejectWithValue:s}=a;if(!e)return s("error");try{const a=await t.api.get("/comments",{params:{articleId:e,_expand:"user"}});if(!a.data)throw new Error;return a.data}catch(e){return console.log(e),s("Error")}})),x=(0,m.HF)({selectId:e=>e.id}),g=x.getSelectors((e=>e.articleDetailsPage?.comments||x.getInitialState())),h=(0,m.oM)({name:"articleDetailsCommentsSlice",initialState:x.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{}}),reducers:{},extraReducers:e=>{e.addCase(u.pending,((e,a)=>{e.error=void 0,e.isLoading=!0})).addCase(u.fulfilled,((e,a)=>{e.isLoading=!1,x.setAll(e,a.payload)})).addCase(u.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload}))}}),{reducer:j}=h,p=(0,m.hg)("articleDetailsPage/fetchArticleRecommendations",(async(e,a)=>{const{extra:t,rejectWithValue:s}=a;try{const e=await t.api.get("/articles",{params:{_limit:4}});if(!e.data)throw new Error;return e.data}catch(e){return console.log(e),s("Error")}})),v=(0,m.HF)({selectId:e=>e.id}),C=(v.getSelectors((e=>e.articleDetailsPage?.recommendations||v.getInitialState())),(0,m.oM)({name:"articleDetaisPageRecommendationsSlice",initialState:v.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{}}),reducers:{},extraReducers:e=>{e.addCase(p.pending,((e,a)=>{e.error=void 0,e.isLoading=!0})).addCase(p.fulfilled,((e,a)=>{e.isLoading=!1,v.setAll(e,a.payload)})).addCase(p.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload}))}})),{reducer:N}=C,w=(0,o.UY)({recommendations:N,comments:j});var L=t(9319),f=t(3694),y=t(5255),A=t(3381);const I=(0,t(2222).P1)(n.wq,A.m5,((e,a)=>!(!e||!a)&&e.user.id===a.id));var b=t(2047),S=t(5893),k=(0,r.memo)((e=>{const{className:a}=e,{t:t,i18n:l}=(0,i.$)("article-details"),d=(0,c.s0)(),o=((0,L.v9)(A.m5),(0,L.v9)(n.wq)),m=(0,L.v9)(I),u=(0,r.useCallback)((()=>{d(f.h3.articles)}),[d]),x=(0,r.useCallback)((()=>{d(`${f.h3.articles_details}/${o?.id}/edit`)}),[d,o?.id]);return(0,S.jsxs)(b.U,{max:!0,justify:"between",className:(0,s.A)("",{},[a]),children:[(0,S.jsx)(y.zx,{theme:y.bn.OUTLINE,onClick:u,children:t("Back to list")}),m&&(0,S.jsx)(y.zx,{theme:y.bn.OUTLINE,onClick:x,children:t("Edit")})]})})),D=t(1715);const E=t(6628).p.injectEndpoints({endpoints:e=>({getArticleRecommendationsList:e.query({query:e=>({url:"/articles",params:{_limit:e}})})})}).useGetArticleRecommendationsListQuery,$=(0,r.memo)((e=>{const{className:a}=e,{t:t,i18n:r}=(0,i.$)(),{isLoading:c,data:l,error:d}=E(3);return c||d||!l?null:(0,S.jsxs)(b.g,{gap:"8",className:(0,s.A)("",{},[a]),children:[(0,S.jsx)(D.xv,{size:D.yH.L,title:t("Recommendations")}),(0,S.jsx)(n.wD,{articles:l,target:"_blank"})]})})),P=(0,r.lazy)((async()=>await t.e(933).then(t.bind(t,1933))));var z=t(2949),O=t(3312),R=t(6897),q={CommentCard:"xIHBy",header:"dsH_3",username:"dw82W",loading:"V0iZ1"},H=(0,r.memo)((e=>{const{className:a,comment:t,isLoading:i}=e;return i?(0,S.jsxs)("div",{className:(0,s.A)(q.CommentCard,{},[a,q.loading]),children:[(0,S.jsxs)("div",{className:q.header,children:[(0,S.jsx)(O.O,{width:30,height:30,border:"50%"}),(0,S.jsx)(O.O,{height:16,width:100,className:q.username})]}),(0,S.jsx)(O.O,{className:q.text,width:"100%",height:50})]}):t?(0,S.jsxs)(b.g,{gap:"8",max:!0,className:(0,s.A)(q.CommentCard,{},[a]),children:[(0,S.jsxs)(R.F,{to:`${f.h3.profile}/${t.user.id}`,className:q.header,children:[t.user.avatar?(0,S.jsx)(z.q,{size:30,src:t.user.avatar}):null,(0,S.jsx)(D.xv,{className:q.username,title:t.user.username})]}),(0,S.jsx)(D.xv,{className:q.text,text:t.text})]}):null}));const U=(0,r.memo)((e=>{const{className:a,comments:t,isLoading:r}=e,{t:n,i18n:c}=(0,i.$)();return r?(0,S.jsxs)(b.g,{gap:"16",max:!0,className:(0,s.A)("",{},[a]),children:[(0,S.jsx)(H,{isLoading:!0}),(0,S.jsx)(H,{isLoading:!0}),(0,S.jsx)(H,{isLoading:!0})]}):(0,S.jsx)(b.g,{gap:"16",max:!0,className:(0,s.A)("",{},[a]),children:t?.length?t.map((e=>(0,S.jsx)(H,{isLoading:r,comment:e},e.id))):(0,S.jsx)(D.xv,{text:n("No comments")})})}));var _=t(9970);const W=e=>e.articleDetailsPage?.comments?.isLoading;var F=t(3986);const V=(0,m.hg)("articleDetails/addCommentForArticle",(async(e,a)=>{const{extra:t,rejectWithValue:s,getState:i,dispatch:r}=a,n=(0,A.m5)(i()),c=(0,F.wq)(i());if(!n||!e||!c)return s("no data");try{const a=await t.api.post("/comments",{articleId:c.id,userId:n.id,text:e});if(!a.data)throw new Error;return r(u(c.id)),a.data}catch(e){return s("Error")}}));var B=(0,r.memo)((e=>{const{className:a,id:t}=e,{t:n,i18n:c}=(0,i.$)("article-details"),l=(0,L.I0)(),d=(0,L.v9)(g.selectAll),o=(0,L.v9)(W),m=(0,r.useCallback)((e=>{l(V(e))}),[l]);return(0,_.Q)((()=>{l(u(t))})),(0,S.jsxs)(b.g,{gap:"16",max:!0,className:(0,s.A)("",{},[a]),children:[(0,S.jsx)(D.xv,{size:D.yH.L,className:"",title:n("Comments")}),(0,S.jsx)(P,{onSendComment:m}),(0,S.jsx)(U,{isLoading:o,comments:d})]})}));const M=(0,r.lazy)((async()=>await t.e(798).then(t.bind(t,7798)))),Q=e=>(0,S.jsx)(r.Suspense,{fallback:(0,S.jsx)(O.O,{width:"100%",height:140}),children:(0,S.jsx)(M,{...e})}),T={articleDetailsPage:w},Z=e=>{let{className:a}=e;const{t:t,i18n:r}=(0,i.$)("article-details"),{id:o}=(0,c.UO)();return o?(0,S.jsx)(l.W,{reducers:T,removeAfterUnmount:!0,children:(0,S.jsx)(d.Z,{className:(0,s.A)("adu8f",{},[a]),children:(0,S.jsxs)(b.g,{gap:"16",max:!0,children:[(0,S.jsx)(k,{}),(0,S.jsx)(n.D0,{id:o}),(0,S.jsx)(Q,{articleId:o}),(0,S.jsx)($,{}),(0,S.jsx)(B,{id:o})]})})}):null};var G=(0,r.memo)(Z)}}]);