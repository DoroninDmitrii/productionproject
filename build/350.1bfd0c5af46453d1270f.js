"use strict";(self.webpackChunkproductionproject=self.webpackChunkproductionproject||[]).push([[350],{3350:function(e,a,r){r.r(a),r.d(a,{default:function(){return Q}});var n=r(2327),l=r(9250),t=r(3007),o=r(8979),s=r(4092),i=r(7294),u=r(9319),d=r(4268);const c=(0,d.hg)("profile/fetchProfileData",(async(e,a)=>{const{extra:r,rejectWithValue:n}=a;try{const a=await r.api.get(`/profile/${e}`);if(!a.data)throw new Error;return a.data}catch(e){return console.log(e),n("Error")}})),v=e=>{var a;return null==e||null===(a=e.profile)||void 0===a?void 0:a.error},C=e=>{var a;return null==e||null===(a=e.profile)||void 0===a?void 0:a.isLoading},m=e=>{var a;return null==e||null===(a=e.profile)||void 0===a?void 0:a.form};let h=function(e){return e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR",e}({});const f=(0,d.hg)("profile/updateProfileData",(async(e,a)=>{const{extra:r,rejectWithValue:n,getState:l}=a,t=m(l()),o=(e=>{if(!e)return[h.NO_DATA];const{first:a,lastname:r,age:n,country:l}=e,t=[];return a&&r||t.push(h.INCORRECT_USER_DATA),n&&Number.isInteger(n)||t.push(h.INCORRECT_AGE),l||t.push(h.INCORRECT_COUNTRY),t})(t);if(o.length)return n(o);try{const e=await r.api.put(`/profile/${(null==t?void 0:t.id)||""}`,t);if(!e.data)throw new Error;return e.data}catch(e){return console.log(e),n([h.SERVER_ERROR])}})),g=(0,d.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:(e,a)=>{e.readonly=a.payload},cancelEdit:e=>{e.readonly=!0,e.validateError=void 0,e.form=e.data},updateProfile:(e,a)=>{e.form={...e.form,...a.payload}}},extraReducers:e=>{e.addCase(c.pending,((e,a)=>{e.error=void 0,e.isLoading=!0})).addCase(c.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload})).addCase(c.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload})).addCase(f.pending,((e,a)=>{e.validateError=void 0,e.isLoading=!0})).addCase(f.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload,e.readonly=!0,e.validateError=void 0})).addCase(f.rejected,((e,a)=>{e.isLoading=!1,e.validateError=a.payload}))}}),{actions:p}=g,{reducer:R}=g,y=e=>{var a;return null==e||null===(a=e.profile)||void 0===a?void 0:a.readonly},E=e=>{var a;return null==e||null===(a=e.profile)||void 0===a?void 0:a.validateError};var x=r(1715),N=r(8312),j=r(379),A=r(2949);let U=function(e){return e.RUB="RUB",e.EUR="EUR",e.USD="USD",e}({});var O=r(9607),T=r(5893);const I=[{value:U.RUB,content:U.RUB},{value:U.EUR,content:U.EUR},{value:U.USD,content:U.USD}];var b=(0,i.memo)((e=>{const{className:a,value:r,onChange:l,readonly:t}=e,{t:o}=(0,n.$)("profile"),s=(0,i.useCallback)((e=>{null==l||l(e)}),[l]);return(0,T.jsx)(O.wb,{className:a,value:r,defaultValue:o("Choose a currency"),label:o("Choose a currency"),onChange:s,items:I,readonly:t,direction:"top right"})}));let k=function(e){return e.Russia="Russia",e.Ukraine="Ukraine",e.Armenia="Armenia",e}({});const _=[{value:k.Russia,content:k.Russia},{value:k.Ukraine,content:k.Ukraine},{value:k.Armenia,content:k.Armenia}];var S=(0,i.memo)((e=>{const{className:a,value:r,onChange:l,readonly:t}=e,{t:o}=(0,n.$)("profile"),s=(0,i.useCallback)((e=>{null==l||l(e)}),[l]);return(0,T.jsx)(O.wb,{className:a,value:r,defaultValue:o("Choose a country"),label:o("Choose a country"),onChange:s,items:_,readonly:t,direction:"top right"})})),P=r(2047),D={ProfileCard:"wW9jg",loading:"t07Zx",error:"i5YK3",editing:"DjTe7"};const L=e=>{const{className:a,data:r,isLoading:l,error:o,readonly:s,onChangeFirstname:i,onChangeLastname:u,onChangeCity:d,onChangeAge:c,onChangeUsername:v,onChangeAvatar:C,onChangeCountry:m,onChangeCurrency:h}=e,{t:f}=(0,n.$)("profile");if(l)return(0,T.jsx)(P.U,{justify:"center",max:!0,className:(0,t.A)(D.ProfileCard,{},[a,D.loading]),children:(0,T.jsx)(j.Z,{})});if(o)return(0,T.jsx)(P.U,{justify:"center",max:!0,className:(0,t.A)(D.ProfileCard,{},[a,D.error]),children:(0,T.jsx)(x.xv,{theme:x.lg.ERROR,title:f("Mistake is happened"),text:f("Try again"),align:x.PH.CENTER})});const g={[D.editing]:!s};return(0,T.jsxs)(P.g,{max:!0,gap:"8",className:(0,t.A)(D.ProfileCard,g,[a]),children:[(null==r?void 0:r.avatar)&&(0,T.jsx)(P.U,{justify:"center",max:!0,className:D.avatarWrapper,children:(0,T.jsx)(A.q,{src:null==r?void 0:r.avatar})}),(0,T.jsx)(N.I,{value:null==r?void 0:r.first,placeholder:f("Your name"),className:D.input,onChange:i,readonly:s}),(0,T.jsx)(N.I,{value:null==r?void 0:r.lastname,placeholder:f("Your surname"),className:D.input,onChange:u,readonly:s}),(0,T.jsx)(N.I,{onKeyPress:e=>{/[0-9]/.test(e.key)||e.preventDefault()},value:null==r?void 0:r.age,placeholder:f("Age"),className:D.input,onChange:c,readonly:s}),(0,T.jsx)(N.I,{value:null==r?void 0:r.city,placeholder:f("City"),className:D.input,onChange:d,readonly:s}),(0,T.jsx)(N.I,{value:null==r?void 0:r.username,placeholder:f("Username"),className:D.input,onChange:v,readonly:s}),(0,T.jsx)(N.I,{value:null==r?void 0:r.avatar,placeholder:f("Avatar"),className:D.input,onChange:C,readonly:s}),(0,T.jsx)(b,{className:D.input,value:null==r?void 0:r.currency,onChange:h,readonly:s}),(0,T.jsx)(S,{className:D.input,value:null==r?void 0:r.country,onChange:m,readonly:s})]})};var w=r(5401),$=r(9970),V=r(1233),Y=r(5255);const F=e=>{var a;return null==e||null===(a=e.profile)||void 0===a?void 0:a.data};var M=r(3381),G=r(3363),W=(0,i.memo)((e=>{const{className:a}=e,{t:r}=(0,n.$)("profile"),l=(0,u.v9)(y),o=(0,u.v9)(M.m5),s=(0,u.v9)(F),d=(0,w.T)(),c=(null==o?void 0:o.id)===(null==s?void 0:s.id),v=(0,i.useCallback)((()=>{d(p.setReadonly(!1))}),[d]),C=(0,i.useCallback)((()=>{d(p.cancelEdit())}),[d]),m=(0,i.useCallback)((()=>{d(f())}),[d]);return(0,T.jsxs)(G.U,{max:!0,justify:"between",className:(0,t.A)("",{},[a]),children:[(0,T.jsx)(x.xv,{title:r("Profile")}),c&&(0,T.jsx)(T.Fragment,{children:l?(0,T.jsx)(Y.zx,{theme:Y.bn.OUTLINE,onClick:v,children:r("Edit")}):(0,T.jsxs)(G.U,{gap:"8",children:[(0,T.jsx)(Y.zx,{theme:Y.bn.OUTLINE_RED,onClick:C,children:r("Cancel")}),(0,T.jsx)(Y.zx,{theme:Y.bn.OUTLINE,onClick:m,children:r("Save")})]})})]})}));const B={profile:R},z=(0,i.memo)((e=>{const{className:a,id:r}=e,{t:l,i18n:o}=(0,n.$)("profile"),s=(0,w.T)(),d=(0,u.v9)(m),f=(0,u.v9)(C),g=(0,u.v9)(v),R=(0,u.v9)(y),N=(0,u.v9)(E),j={[h.SERVER_ERROR]:l("Server error"),[h.NO_DATA]:l("Data is absented"),[h.INCORRECT_USER_DATA]:l("Incorrect user data"),[h.INCORRECT_COUNTRY]:l("Incorrect country"),[h.INCORRECT_AGE]:l("Incorrect age")};(0,$.Q)((()=>{r&&s(c(r))}));const A=(0,i.useCallback)((e=>{s(p.updateProfile({first:e||""}))}),[s]),U=(0,i.useCallback)((e=>{s(p.updateProfile({lastname:e||""}))}),[s]),O=(0,i.useCallback)((e=>{s(p.updateProfile({age:Number(e||0)}))}),[s]),I=(0,i.useCallback)((e=>{s(p.updateProfile({city:e||""}))}),[s]),b=(0,i.useCallback)((e=>{s(p.updateProfile({username:e||""}))}),[s]),k=(0,i.useCallback)((e=>{s(p.updateProfile({avatar:e||""}))}),[s]),_=(0,i.useCallback)((e=>{s(p.updateProfile({currency:e}))}),[s]),S=(0,i.useCallback)((e=>{s(p.updateProfile({country:e}))}),[s]);return(0,T.jsx)(V.W,{reducers:B,removeAfterUnmount:!0,children:(0,T.jsxs)(P.g,{gap:"8",max:!0,className:(0,t.A)("",{},[a]),children:[(0,T.jsx)(W,{}),(null==N?void 0:N.length)&&N.map((e=>(0,T.jsx)(x.xv,{theme:x.lg.ERROR,text:j[e]},e))),(0,T.jsx)(L,{data:d,isLoading:f,error:g,onChangeFirstname:A,onChangeLastname:U,onChangeAge:O,onChangeCity:I,onChangeUsername:b,onChangeAvatar:k,onChangeCurrency:_,onChangeCountry:S,readonly:R})]})})}));var Q=e=>{let{className:a}=e;const{t:r,i18n:i}=(0,n.$)("profile"),{id:u}=(0,l.UO)();return(0,T.jsx)(o.Z,{className:(0,t.A)("",{},[a]),children:(0,T.jsx)(s.g,{max:!0,gap:"16",children:(0,T.jsx)(z,{id:u})})})}},1233:function(e,a,r){r.d(a,{W:function(){return o}});var n=r(7294),l=r(9319),t=r(5893);const o=e=>{const{children:a,reducers:r,removeAfterUnmount:o}=e,s=(0,l.oR)(),i=(0,l.I0)();return(0,n.useEffect)((()=>{const e=s.reducerManager.getMountedReducers();return Object.entries(r).forEach((a=>{let[r,n]=a;e[r]||(s.reducerManager.add(r,n),i({type:`@INIT ${r} reducer`}))})),()=>{o&&Object.entries(r).forEach((e=>{let[a,r]=e;s.reducerManager.remove(a),i({type:`@DESTROY ${a} reducer`})}))}}),[]),(0,t.jsx)(t.Fragment,{children:a})}},8312:function(e,a,r){r.d(a,{I:function(){return o}});var n=r(3007),l=r(7294),t=r(5893);const o=(0,l.memo)((e=>{const{className:a,value:r,onChange:o,type:s="text",placeholder:i,autofocus:u,readonly:d,...c}=e,[v,C]=(0,l.useState)(!1),[m,h]=(0,l.useState)(0),f=(0,l.useRef)(null),g=v&&!d;return(0,l.useEffect)((()=>{var e;u&&(C(!0),null===(e=f.current)||void 0===e||e.focus())}),[u]),(0,t.jsxs)("div",{className:(0,n.A)("yiPAS",{},[a]),children:[i&&(0,t.jsx)("div",{className:"emAQQ",children:`${i}>`}),(0,t.jsxs)("div",{className:"y1GiF",children:[(0,t.jsx)("input",{ref:f,type:s,value:r,onChange:e=>{null==o||o(e.target.value),h(e.target.value.length)},className:"LVdIP",onFocus:()=>{C(!0)},onBlur:()=>{C(!1)},onSelect:e=>{var a;h((null==e||null===(a=e.target)||void 0===a?void 0:a.selectionStart)||0)},readOnly:d,...c}),g&&(0,t.jsx)("span",{className:"lqMFG",style:{left:9*m+"px"}})]})]})}))}}]);