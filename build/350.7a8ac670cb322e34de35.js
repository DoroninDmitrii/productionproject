"use strict";(self.webpackChunkproductionproject=self.webpackChunkproductionproject||[]).push([[350],{3350:(e,n,r)=>{r.r(n),r.d(n,{default:()=>ee});var a=r(4478),t=r(9250),o=r(3007),l=r(8979),i=r(4092),u=r(4942),c=r(7294),s=r(9319),d=r(5861),f=r(4687),v=r.n(f),p=r(4268),h=(0,p.hg)("profile/fetchProfileData",function(){var e=(0,d.Z)(v().mark((function e(n,r){var a,t,o;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.extra,t=r.rejectWithValue,e.prev=1,e.next=4,a.api.get("/profile/".concat(n));case 4:if((o=e.sent).data){e.next=7;break}throw new Error;case 7:return e.abrupt("return",o.data);case 10:return e.prev=10,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return",t("Error"));case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n,r){return e.apply(this,arguments)}}()),g=function(e){var n;return null==e||null===(n=e.profile)||void 0===n?void 0:n.error},C=function(e){var n;return null==e||null===(n=e.profile)||void 0===n?void 0:n.isLoading},m=function(e){var n;return null==e||null===(n=e.profile)||void 0===n?void 0:n.form},y=function(e){return e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_COUNTRY="INCORRECT_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR",e}({}),R=function(e){if(!e)return[y.NO_DATA];var n=e.first,r=e.lastname,a=e.age,t=e.country,o=[];return n&&r||o.push(y.INCORRECT_USER_DATA),a&&Number.isInteger(a)||o.push(y.INCORRECT_AGE),t||o.push(y.INCORRECT_COUNTRY),o},j=(0,p.hg)("profile/updateProfileData",function(){var e=(0,d.Z)(v().mark((function e(n,r){var a,t,o,l,i,u;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.extra,t=r.rejectWithValue,o=r.getState,l=m(o()),!(i=R(l)).length){e.next=5;break}return e.abrupt("return",t(i));case 5:return e.prev=5,e.next=8,a.api.put("/profile/".concat((null==l?void 0:l.id)||""),l);case 8:if((u=e.sent).data){e.next=11;break}throw new Error;case 11:return e.abrupt("return",u.data);case 14:return e.prev=14,e.t0=e.catch(5),console.log(e.t0),e.abrupt("return",t([y.SERVER_ERROR]));case 18:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(n,r){return e.apply(this,arguments)}}());function O(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,a)}return r}function x(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?O(Object(r),!0).forEach((function(n){(0,u.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var b=(0,p.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:function(e,n){e.readonly=n.payload},cancelEdit:function(e){e.readonly=!0,e.validateError=void 0,e.form=e.data},updateProfile:function(e,n){e.form=x(x({},e.form),n.payload)}},extraReducers:function(e){e.addCase(h.pending,(function(e,n){e.error=void 0,e.isLoading=!0})).addCase(h.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload})).addCase(h.rejected,(function(e,n){e.isLoading=!1,e.error=n.payload})).addCase(j.pending,(function(e,n){e.validateError=void 0,e.isLoading=!0})).addCase(j.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload,e.readonly=!0,e.validateError=void 0})).addCase(j.rejected,(function(e,n){e.isLoading=!1,e.validateError=n.payload}))}}),E=b.actions,N=b.reducer,A=function(e){var n;return null==e||null===(n=e.profile)||void 0===n?void 0:n.readonly},U=function(e){var n;return null==e||null===(n=e.profile)||void 0===n?void 0:n.validateError},P=r(1715),T=r(8312),k=r(379),I=r(2949),D=function(e){return e.RUB="RUB",e.EUR="EUR",e.USD="USD",e}({}),w=r(9607),S=r(5893),_=[{value:D.RUB,content:D.RUB},{value:D.EUR,content:D.EUR},{value:D.USD,content:D.USD}];const Z=(0,c.memo)((function(e){var n=e.className,r=e.value,t=e.onChange,o=e.readonly,l=(0,a.$)("profile").t,i=(0,c.useCallback)((function(e){null==t||t(e)}),[t]);return(0,S.jsx)(w.wb,{className:n,value:r,defaultValue:l("Choose a currency"),label:l("Choose a currency"),onChange:i,items:_,readonly:o,direction:"top right"})}));var L=function(e){return e.Russia="Russia",e.Ukraine="Ukraine",e.Armenia="Armenia",e}({}),V=[{value:L.Russia,content:L.Russia},{value:L.Ukraine,content:L.Ukraine},{value:L.Armenia,content:L.Armenia}];const Y=(0,c.memo)((function(e){var n=e.className,r=e.value,t=e.onChange,o=e.readonly,l=(0,a.$)("profile").t,i=(0,c.useCallback)((function(e){null==t||t(e)}),[t]);return(0,S.jsx)(w.wb,{className:n,value:r,defaultValue:l("Choose a country"),label:l("Choose a country"),onChange:i,items:V,readonly:o,direction:"top right"})}));var F=r(2047);const M={ProfileCard:"wW9jg",loading:"t07Zx",error:"i5YK3",editing:"DjTe7"};var G=function(e){var n=e.className,r=e.data,t=e.isLoading,l=e.error,i=e.readonly,c=e.onChangeFirstname,s=e.onChangeLastname,d=e.onChangeCity,f=e.onChangeAge,v=e.onChangeUsername,p=e.onChangeAvatar,h=e.onChangeCountry,g=e.onChangeCurrency,C=(0,a.$)("profile").t;if(t)return(0,S.jsx)(F.U,{justify:"center",max:!0,className:(0,o.A)(M.ProfileCard,{},[n,M.loading]),children:(0,S.jsx)(k.Z,{})});if(l)return(0,S.jsx)(F.U,{justify:"center",max:!0,className:(0,o.A)(M.ProfileCard,{},[n,M.error]),children:(0,S.jsx)(P.xv,{theme:P.lg.ERROR,title:C("Mistake is happened"),text:C("Try again"),align:P.PH.CENTER})});var m=(0,u.Z)({},M.editing,!i);return(0,S.jsxs)(F.g,{max:!0,gap:"8",className:(0,o.A)(M.ProfileCard,m,[n]),children:[(null==r?void 0:r.avatar)&&(0,S.jsx)(F.U,{justify:"center",max:!0,className:M.avatarWrapper,children:(0,S.jsx)(I.q,{src:null==r?void 0:r.avatar})}),(0,S.jsx)(T.I,{value:null==r?void 0:r.first,placeholder:C("Your name"),className:M.input,onChange:c,readonly:i}),(0,S.jsx)(T.I,{value:null==r?void 0:r.lastname,placeholder:C("Your surname"),className:M.input,onChange:s,readonly:i}),(0,S.jsx)(T.I,{onKeyPress:function(e){/[0-9]/.test(e.key)||e.preventDefault()},value:null==r?void 0:r.age,placeholder:C("Age"),className:M.input,onChange:f,readonly:i}),(0,S.jsx)(T.I,{value:null==r?void 0:r.city,placeholder:C("City"),className:M.input,onChange:d,readonly:i}),(0,S.jsx)(T.I,{value:null==r?void 0:r.username,placeholder:C("Username"),className:M.input,onChange:v,readonly:i}),(0,S.jsx)(T.I,{value:null==r?void 0:r.avatar,placeholder:C("Avatar"),className:M.input,onChange:p,readonly:i}),(0,S.jsx)(Z,{className:M.input,value:null==r?void 0:r.currency,onChange:g,readonly:i}),(0,S.jsx)(Y,{className:M.input,value:null==r?void 0:r.country,onChange:h,readonly:i})]})},W=r(5401),$=r(9970),B=r(1233),z=r(5255),Q=function(e){var n;return null==e||null===(n=e.profile)||void 0===n?void 0:n.data},q=r(3381),K=r(3363);const H=(0,c.memo)((function(e){var n=e.className,r=(0,a.$)("profile").t,t=(0,s.v9)(A),l=(0,s.v9)(q.m5),i=(0,s.v9)(Q),u=(0,W.T)(),d=(null==l?void 0:l.id)===(null==i?void 0:i.id),f=(0,c.useCallback)((function(){u(E.setReadonly(!1))}),[u]),v=(0,c.useCallback)((function(){u(E.cancelEdit())}),[u]),p=(0,c.useCallback)((function(){u(j())}),[u]);return(0,S.jsxs)(K.U,{max:!0,justify:"between",className:(0,o.A)("",{},[n]),children:[(0,S.jsx)(P.xv,{title:r("Profile")}),d&&(0,S.jsx)(S.Fragment,{children:t?(0,S.jsx)(z.zx,{theme:z.bn.OUTLINE,onClick:f,children:r("Edit")}):(0,S.jsxs)(K.U,{gap:"8",children:[(0,S.jsx)(z.zx,{theme:z.bn.OUTLINE_RED,onClick:v,children:r("Cancel")}),(0,S.jsx)(z.zx,{theme:z.bn.OUTLINE,onClick:p,children:r("Save")})]})})]})}));var J={profile:N},X=(0,c.memo)((function(e){var n,r=e.className,t=e.id,l=(0,a.$)("profile"),i=l.t,d=(l.i18n,(0,W.T)()),f=(0,s.v9)(m),v=(0,s.v9)(C),p=(0,s.v9)(g),R=(0,s.v9)(A),j=(0,s.v9)(U),O=(n={},(0,u.Z)(n,y.SERVER_ERROR,i("Server error")),(0,u.Z)(n,y.NO_DATA,i("Data is absented")),(0,u.Z)(n,y.INCORRECT_USER_DATA,i("Incorrect user data")),(0,u.Z)(n,y.INCORRECT_COUNTRY,i("Incorrect country")),(0,u.Z)(n,y.INCORRECT_AGE,i("Incorrect age")),n);(0,$.Q)((function(){t&&d(h(t))}));var x=(0,c.useCallback)((function(e){d(E.updateProfile({first:e||""}))}),[d]),b=(0,c.useCallback)((function(e){d(E.updateProfile({lastname:e||""}))}),[d]),N=(0,c.useCallback)((function(e){d(E.updateProfile({age:Number(e||0)}))}),[d]),T=(0,c.useCallback)((function(e){d(E.updateProfile({city:e||""}))}),[d]),k=(0,c.useCallback)((function(e){d(E.updateProfile({username:e||""}))}),[d]),I=(0,c.useCallback)((function(e){d(E.updateProfile({avatar:e||""}))}),[d]),D=(0,c.useCallback)((function(e){d(E.updateProfile({currency:e}))}),[d]),w=(0,c.useCallback)((function(e){d(E.updateProfile({country:e}))}),[d]);return(0,S.jsx)(B.W,{reducers:J,removeAfterUnmount:!0,children:(0,S.jsxs)(F.g,{gap:"8",max:!0,className:(0,o.A)("",{},[r]),children:[(0,S.jsx)(H,{}),(null==j?void 0:j.length)&&j.map((function(e){return(0,S.jsx)(P.xv,{theme:P.lg.ERROR,text:O[e]},e)})),(0,S.jsx)(G,{data:f,isLoading:v,error:p,onChangeFirstname:x,onChangeLastname:b,onChangeAge:N,onChangeCity:T,onChangeUsername:k,onChangeAvatar:I,onChangeCurrency:D,onChangeCountry:w,readonly:R})]})})}));const ee=function(e){var n=e.className,r=(0,a.$)("profile"),u=(r.t,r.i18n,(0,t.UO)().id);return(0,S.jsx)(l.Z,{className:(0,o.A)("",{},[n]),children:(0,S.jsx)(i.g,{max:!0,gap:"16",children:(0,S.jsx)(X,{id:u})})})}},1233:(e,n,r)=>{r.d(n,{W:()=>i});var a=r(9439),t=r(7294),o=r(9319),l=r(5893),i=function(e){var n=e.children,r=e.reducers,i=e.removeAfterUnmount,u=(0,o.oR)(),c=(0,o.I0)();return(0,t.useEffect)((function(){var e=u.reducerManager.getMountedReducers();return Object.entries(r).forEach((function(n){var r=(0,a.Z)(n,2),t=r[0],o=r[1];e[t]||(u.reducerManager.add(t,o),c({type:"@INIT ".concat(t," reducer")}))})),function(){i&&Object.entries(r).forEach((function(e){var n=(0,a.Z)(e,2),r=n[0];n[1],u.reducerManager.remove(r),c({type:"@DESTROY ".concat(r," reducer")})}))}}),[]),(0,l.jsx)(l.Fragment,{children:n})}},8312:(e,n,r)=>{r.d(n,{I:()=>f});var a=r(4942),t=r(9439),o=r(4925),l=r(3007),i=r(7294);var u=r(5893),c=["className","value","onChange","type","placeholder","autofocus","readonly"];function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,a)}return r}function d(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){(0,a.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var f=(0,i.memo)((function(e){var n=e.className,r=e.value,s=e.onChange,f=e.type,v=void 0===f?"text":f,p=e.placeholder,h=e.autofocus,g=e.readonly,C=(0,o.Z)(e,c),m=(0,i.useState)(!1),y=(0,t.Z)(m,2),R=y[0],j=y[1],O=(0,i.useState)(0),x=(0,t.Z)(O,2),b=x[0],E=x[1],N=(0,i.useRef)(null),A=R&&!g;return(0,i.useEffect)((function(){var e;h&&(j(!0),null===(e=N.current)||void 0===e||e.focus())}),[h]),(0,a.Z)({},"fTN1P",g),(0,u.jsxs)("div",{className:(0,l.A)("yiPAS",{},[n]),children:[p&&(0,u.jsx)("div",{className:"emAQQ",children:"".concat(p,">")}),(0,u.jsxs)("div",{className:"y1GiF",children:[(0,u.jsx)("input",d({ref:N,type:v,value:r,onChange:function(e){null==s||s(e.target.value),E(e.target.value.length)},className:"LVdIP",onFocus:function(){j(!0)},onBlur:function(){j(!1)},onSelect:function(e){var n;E((null==e||null===(n=e.target)||void 0===n?void 0:n.selectionStart)||0)},readOnly:g},C)),A&&(0,u.jsx)("span",{className:"lqMFG",style:{left:"".concat(9*b,"px")}})]})]})}))}}]);